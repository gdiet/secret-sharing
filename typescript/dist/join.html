<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Secret Sharing</title>
    <script src="conversionUtilities.js" defer></script>
    <script src="documentUtilities.js" defer></script>
    <script src="gf256Math.js" defer></script>
    <script src="secretSharing.js" defer></script>
    <script src="utilities.js" defer></script>
    <!-- The page automation script must be loaded last. -->
    <script src="joinPageAutomation.js" defer></script>
    <link rel="stylesheet" href="common.css" />
  </head>

  <body>
    <h1>Restoring Shared Secrets Like Passwords</h1>
    <p><a href="index.html">[Main Page]</a></p>
    <p id="javascriptWarning" class="problem">
      What the heck! This page needs JavaScript, and it seems that JavaScript is not enabled. Maybe you want to use a
      different browser?
    </p>
    <p id="cryptoWarning" class="problem">
      Oh bother! The hashing functionality of this page (used for verification of the restored secret) uses
      'crypto.subtle' which is only available in a so-called secure context. It seems that your browser thinks the
      context of this page is not secure. Maybe you can use a different browser or load this page from a different
      context? Otherwise, you can't verify the secret - restoring the secret itself is not affectd.
    </p>
    <p>
      Hey there! Are you here because you have a number of so-called shares for a secret like a password and you want to
      re-create the secret from them? If yes, and if the shares were created with
      <a href="share-compact.html">this (compact notation)</a> or
      <a href="share-json.html">this (JSON notation)</a> tool, then you are in the right place.
    </p>
    <p>
      So you have shares data in compact or JSON notation. Put them in the input fields below, replacing the example
      shares data there:
    </p>
    <div id="shareInputs"><!-- Here, the page automation will generate share input UI elements. --></div>
    <p>
      <label for="secretInput">Secret or password restored from the above shares:</label><br />
      <input id="secretInput" class="textinput" type="text" value="" size="100" readonly />
    </p>
    <p>
      Validation of secret through shared hash: <i><span id="hashValidSpan">Not validated</span></i>
    </p>
    <p>
      Share identifiers match: <i><span id="identifierValidSpan">Not validated</span></i>
    </p>
    <p>
      Restore status: <i><span id="restoreStatusSpan">OK</span></i>
    </p>
    <hr />
    <p>
      For detailed technical information on what is going on here, create any shares on the share-creation pages (see
      above) and read the information provided with them. If you are a nerd, here is the summary information: Shamir's
      Secret Sharing, GF256 with polynomial 0x11b, UTF-8, lower-endian bytes, first byte of share is the share's x
      value, secret possibly padded with trailing zeros, share verification SHA-256 hash of unpadded secret, random
      identifier.
    </p>
    <p>
      Also, maybe you'd like to see the
      <a href="https://github.com/gdiet/secret-sharing/tree/main/typescript">source code of these pages on GitHub</a> or
      download the <a href="secret-sharing.zip">full distribution package</a> of these pages which can simply be
      unzipped and opened in a browser. It also contains the project's sources (mainly Typescript & HTML).
    </p>
  </body>
</html>
