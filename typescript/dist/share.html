<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secret Sharing</title>
  <script src="conversionUtilities.js" defer></script>
  <script src="documentUtilities.js" defer></script>
  <script src="gf256Math.js" defer></script>
  <script src="secretSharing.js" defer></script>
  <!-- The page automation script must be loaded last. -->
  <script src="sharePageAutomation.js" defer></script>
</head>

<body>
  <h1>Securely Sharing Secrets Like Passwords</h1>
  <p>Secret or password: <input id="secretInput" type="text" value="Â¡secret!" size="50"></p>
  <p>Pad secret to length: <input id="padToLengthInput" type="number" min="0" max="64" step="1" value="32"></p>
  <p>Number of shares to create: <input id="numberOfSharesInput" type="number" min="2" max="255" step="1" value="3"></p>
  <p>Number of shares (threshold) needed to recover the secret: <input id="thresholdInput" type="number" min="2" max="255" step="1" value="2"></p>
  <p>Optional description of the shares:</p>
  <p><textarea id="sharesDescriptionInput" rows="3" cols="80">
    Example description: Mary's 2023 bank account user:password at TheBigBank.boom, shared with her relatives for emergency situations
  </textarea></p>
  <p><button id="createSharesButton">Create Shares</button></p>
  <p>Shamir's Secret Sharing, GF256 with polynomial 0x11b, utf-8, lower-endian bytes, first byte of share is the share's x value, secret possibly padded with trailing zeros, share verification SHA-256 hash of unpadded secret, random identifier, timestamp ISO 8601 like 2009-06-30T18:30:00+02:00.</p>

  <div id="shareInfoDiv" hidden="true">
    <p>Below find the shares for your secret or password. Beneath the shares, there is a proposal how to share them with people so they know what they have received - and have a chance to remember it even ten years from now.</p>
    <hr>
    <div id="sharesDiv"></div>
    <hr>
    <p>The following is an example how you could share these shares with people - modify or abbreviate as needed:</p>
    <p><i>This is a so-called share of <span id="sharesDescriptionSpan">TEMPLATE Mary's 2023 bank account user:password at TheBigBank.boom, shared with her relatives for emergency situations TEMPLATE</span>. Please store it in a safe location, for example in your password safe. You have received this share so in an emergency you - together with other persons who have received other shares - can reconstruct the secret or password and do whatever is necessary. This is one of <span id="numberOfSharesSpan">TEMPLATE 5 TEMPLATE</span> shares created on <span id="createdDateSpan">TEMPLATE 2023-12-10 TEMPLATE</span>. To reconstruct the secret or password, <span id="thresholdSpan">TEMPLATE 3 TEMPLATE</span> different shares are needed. For the actual reconstruction, this text is not needed - you only need the following data:</i></p>
    <pre>
{
  "part number"   : 1,
  "part of secret": "xxxxxxxxxxxx",
  "part of hash"  : "xxxxxxxxxxxx",
  "identifier"    : "111111"
}</pre>
    <p><i>This share was created with the share tool from <a href="https://gdiet.github.io/secret-sharing/">https://gdiet.github.io/secret-sharing/</a>. On the same site, find the tool for reconstructing the secret or password from shares.</i></p>
    <p><i>Technical description: The "part of secret" is a Base64 encoded byte array. The first byte of the array is the "x" value, all following bytes are "y" values. To reconstruct the original secret's first byte, you combine the "x" value of each "part of secret" share you have with its second byte as "y" value. This gives you a number of "x/y" pairs. Then you do a <a href="https://en.wikipedia.org/wiki/Lagrange_polynomial">Lagrange interpolation</a> to calculate the "y" value for "x = 0". This "y" value is the original secret's first byte. In the same way, you combine the "x" values with the third bytes to calculate the secret's second byte, and so on. Ignore trailing zeros in the reconstructed secret - they were added as a security measure and are not part of the original secret. Note that the Lagrange interpolation must be calculated using the "GF(256)" Galois field with "x^8 + x^4 + x^3 + x^1 + x^0" (or 0x11b) as reducing polynomial. By the way: This is the same field and polynomial as used for calculations by the AES encryption.</i></p>
    <p><i>From the "part of hash", you can reconstruct in the same way the SHA-256 hash of the original secret (without any zero padding). This can be used to verify that the reconstructed secret is in fact the same as the original.</i></p>
    <p><i>The "identifier" field can be used to check whether shares can be combined at all: If the identifiers differ, the shares most probably belong to different instances or even different original secrets, and combining them will not yields meaningful results.</i></p>
    <p><i>The "part number" field is the same as the "x" value of the shares. It is to facilitate (for humans) to check that shares differ - it is not evaluated during reconstruction of the secrets.</i></p>  </div>
</body>

</html>
