<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>xor ⊕ For Secret Sharing</title>
</head>

<body>
  <h1>xor ⊕ For Secret Sharing</h1>
  <p>
    This page demonstrates the "xor ⊕" method for distributing a secret among a group, in such a way that no individual holds any intelligible information about the secret, but when all individuals combine their 'shares', the secret may be reconstructed.
  </p>

  <p>
    The "⊕" operator is used to symbolize a <a href="https://en.wikipedia.org/wiki/Bitwise_operation#XOR">bitwise xor</a>. For calculations use unsigned bytes holding values from 0 to 255.
  </p>

  <p>
    The secret, e.g. "¡secret!", is shared among K individuals as follows:
    <ol>
      <li>
        UTF-8 convert the secret text to a list of N bytes
        <math>
          <msubsup><mi>b</mi><mi>1</mi><mi>secret</mi></msubsup>
          <mi>…</mi>
          <msubsup><mi>b</mi><mi>N</mi><mi>secret</mi></msubsup>
        </math>
      </li>
      <li>
        Fill <math><mo>(</mo><mi>K</mi><mo>-</mo><mn>1</mn><mo>)</mo></math> lists of the same size <math><mi>N</mi></math> with random bytes
        <math>
          <msubsup><mi>b</mi><mi>i</mi><mi>1</mi></msubsup>
          <mi>…</mi>
          <msubsup><mi>b</mi><mi>i</mi><mi>K-1</mi></msubsup>
        </math>
      </li>
      <li>
        Create a list <math><mi>K</mi></math> of bytes from the element wise <math><mo>⊕</mo></math> combination of all lists:<br>
        <math>
          <msubsup><mi>b</mi><mi>i</mi><mi>K</mi></msubsup>
          <mo>=</mo>
          <msubsup><mi>b</mi><mi>i</mi><mi>secret</mi></msubsup>
          <mo>⊕</mo>
          <msubsup><mi>b</mi><mi>i</mi><mi>1</mi></msubsup>
          <mo>⊕</mo> <mi>…</mi> <mo>⊕</mo>
          <msubsup><mi>b</mi><mi>i</mi><mi>K-1</mi></msubsup>
        </math>
      </li>
      <li>
        The lists
        <math>
          <msubsup><mi>b</mi><mi>i</mi><mi>1</mi></msubsup>
          <mi>…</mi>
          <msubsup><mi>b</mi><mi>i</mi><mi>K</mi></msubsup>
        </math>
        are the shares
      </li>
    </ol>
  </p>

  <p>
    Reconstruct the secret from the shares as follows:
    <ol>
      <li value="5">
        Create the list of secret bytes from the element wise <math><mo>⊕</mo></math> combination of all shares:<br>
        <math>
          <msubsup><mi>b</mi><mi>i</mi><mi>secret</mi></msubsup>
          <mo>=</mo>
          <msubsup><mi>b</mi><mi>i</mi><mi>1</mi></msubsup>
          <mo>⊕</mo> <mi>…</mi> <mo>⊕</mo>
          <msubsup><mi>b</mi><mi>i</mi><mi>K</mi></msubsup>
        </math>
      </li>
      <li>
        UTF-8 convert the secret bytes to text
      </li>
    </ol>
  </p>

  <h3>1. UTF-8 Convert Text To Bytes</h3>
  <p>
    This secret sharing method takes as input unsigned bytes holding values from 0 to 255. To share a secret text, use <a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> to convert between text and list-of-bytes.
  </p>
  <p>Text: <input id="textInput" type="text" value="¡secret!" size="50"></p>
  <p>
    <button id="textToBytesButton">⇊ UTF-8 convert ⇊</button> <button id="bytesToTextButton">⇈ UTF-8 convert ⇈</button>
  </p>
  <p>
    Secret bytes: <input id="numbersInput" type="text" size="50">
  </p>
  <script>
    document.getElementById('textToBytesButton').addEventListener('click', () => {
      document.getElementById('numbersInput').value =
        Array.from(
          new TextEncoder().encode(
            document.getElementById('textInput').value
          )
        ).join(',')
    })
    document.getElementById('bytesToTextButton').addEventListener('click', () => {
      document.getElementById('textInput').value =
        new TextDecoder().decode(
          new Uint8Array(
            document.getElementById('numbersInput').value
              .split(',').map(n => parseInt(n))
          )
        )
    })
  </script>

  <hr>

  <p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
    <a rel="license"
       href="http://creativecommons.org/publicdomain/zero/1.0/">
      <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0" />
    </a>
    <br />
    To the extent possible under law,
    <a rel="dct:publisher"
       href="https://github.com/gdiet/">
      <span property="dct:title">gdiet</span></a>
    has waived all copyright and related or neighboring rights to
    these pages about
    <span property="dct:title">Secret Sharing</span>.
  This work is published from:
  <span property="vcard:Country" datatype="dct:ISO3166"
        content="DE" about="sharing-url">
    Germany</span>.
  </p>

</body>
</html>
